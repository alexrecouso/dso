geom_vline(xintercept=1960, color="red", size=0.2) +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy1)))+
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy2)))+
theme_bw()
# Let's implement the gradual change using regression model
# create ramp for gradual change
ozone$Ramp1 = c(rep(0,60),1:156)
ozone$Ramp2 = c(rep(0,132),1:84)
ozone
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp1 + Ramp2, data=ozone)
summary(M2)
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="brown")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy1)))+
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy2)))+
theme_bw() + geom_point(mapping=aes(x=Year,y=M2),col="magenta")
M1 = lm(ozone ~ Dummy1 + Dummy2, data=ozone)
summary(M1)
# Create a graph to show how regression fits the data
#fix this one
ozone$M1 = M1$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy1)))+
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy2)))+
theme_bw()
# Let's implement the gradual change using regression model
# create ramp for gradual change
ozone$Ramp1 = c(rep(0,60),1:156)
ozone$Ramp2 = c(rep(0,132),1:84)
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp1 + Ramp2, data=ozone)
summary(M2)
# Create a graph to show how regression fits the data
#fix this
ozone$M2 = M2$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() + geom_point(mapping=aes(x=Year,y=M2),col="magenta")
M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
summary(M3)
# Create a graph to show how regression fits the data
ozone$M3 = M3$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="brown")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp2, data=ozone)
summary(M3)
#M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
summary(M3)
# Create a graph to show how regression fits the data
ozone$M3 = M3$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="brown")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
#M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp2, data=ozone)
summary(M3)
# Create a graph to show how regression fits the data
ozone$M3 = M3$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="brown")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +
geom_point(mapping=aes(x=Year,y=M3),col="blue")
#M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp2, data=ozone)
summary(M3)
# Create a graph to show how regression fits the data
ozone$M3 = M3$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +
geom_point(mapping=aes(x=Year,y=M3),col="blue")
summary(M3)
#M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
M3 = lm(ozone ~ Dummy1 + Ramp2, data=ozone)
summary(M3)
# Create a graph to show how regression fits the data
ozone$M3 = M3$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +
geom_point(mapping=aes(x=Year,y=M3),col="blue")
summary(M3)
#1
ozone = read.table('dtwnLAozone.txt', skip=2, header=TRUE)
head(ozone)
ozone = ozone %>% as.matrix %>% melt %>%
rename(Year=Var1, MonthShort=Var2, ozone=value) %>% arrange(Year, MonthShort)
ozone %>% head
ozone %>% tail
ozone %>% ggplot(aes(x=Year,y=ozone))+
geom_point()+ theme_bw() + geom_vline(xintercept=1960, color="red", size=0.2)
ozone %>% ggplot(aes(group=Year, x=Year,y=ozone, fill=Year)) +
geom_boxplot(outlier.colour = 'Green') + theme(legend.position = 'none') +
geom_vline(xintercept=1960, color="red", size=0.2)
#Ha: Intervention was effective and reduced pollution
#Ho: Intervention was not effective and did not reduce pollution
#Tolerance level alpha = 0.05 = 5%
#Carry out 2 sample t-test to assess whether the intervention was effective
before1960 = ozone %>% filter(Year < 1960)
after1960 = ozone %>% filter(Year >= 1960 & Year < 1966) #because in 1966 new
#regulations were introduced and we don't want them to contaminate the sample
t.test(x= before1960$ozone, y=after1960$ozone, alternative="greater")
#Let's visualize the difference
ozone1 = ozone[1:132,] #again we leave data after 1966
ozone1 %>% ggplot(aes(group=Year, x=Year, y=ozone, fill=Year)) +
geom_boxplot(outlier.colour = 'Green') + theme(legend.position = 'none') +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_hline(yintercept=mean(before1960$ozone), color="blue")+
geom_hline(yintercept=mean(after1960$ozone), color="magenta")+
theme_bw()
# Let's implement the abrupt change using regression model
# We create a dummy variable 0/1 and call it 'Dummy'
ozone1$Dummy = 0
ozone1$Dummy[61:132] = 1
M1 = lm(ozone ~ Dummy, data=ozone1)
summary(M1)
# Create a graph to show how regression fits the data
ozone1$M1 = M1$fitted.values
ozone1 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
# create ramp for gradual change
ozone1$Ramp = c(rep(0,60),1:72)
ozone1
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp, data=ozone1)
summary(M2)
summary(M2)
# Create a graph to show how regression fits the data
ozone1$M2 = M2$fitted.values
ozone1 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy))) +
theme_bw() +
geom_point(mapping=aes(x=Year, y=M2), col="magenta")
summary(M2)
summary(M1)
summary(M2)
#Which one do you think it is more appropriate and meaningful?
# I think a mix of abrupt and gradual change is more appropriate, so let's check it
M3 = lm(ozone ~ Dummy + Ramp, data=ozone1)
#Which one do you think it is more appropriate and meaningful?
# I think a mix of abrupt and gradual change is more appropriate, so let's check it
M3 = lm(ozone ~ Dummy + Ramp, data=ozone1)
summary(M3)
ozone1 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M3, col=as.factor(Dummy)))+
theme_bw()
ozone1 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M3, col="magenta"))+
theme_bw()
# Create a graph to show how regression fits the data
ozone1$M3 = M3$fitted.values
ozone1 %>% ggplot(mapping=aes(x=Year, y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M3, col="magenta"))+
theme_bw()
summary(M3)
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp, data=ozone1)
summary(M2)
#Ha: Intervention was effective and reduced pollution
#Ho: Intervention was not effective and did not reduce pollution
#Tolerance level alpha = 0.05 = 5%
#Carry out 2 sample t-test to assess whether the intervention was effective
before1966 = ozone %>% filter(Year < 1966)
after1966 = ozone %>% filter(Year >= 1966)
#Let's visualize the difference
ozone %>% ggplot(aes(group=Year, x=Year,y=ozone, fill=Year)) +
geom_boxplot(outlier.colour = 'Green') + theme(legend.position = 'none') +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_hline(yintercept=mean(before1966$ozone), color="blue")+
geom_hline(yintercept=mean(after1966$ozone), color="magenta")+
theme_bw()
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp, data=ozone1)
summary(M2)
ozone1 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy))) +
theme_bw() +
geom_point(mapping=aes(x=Year, y=M2), col="magenta")
#Which one do you think it is more appropriate and meaningful?
# I think a mix of abrupt and gradual change is more appropriate, so let's check it
M3 = lm(ozone ~ Dummy + Ramp, data=ozone1)
summary(M3)
ozone1 %>% ggplot(mapping=aes(x=Year, y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M3, col="magenta"))+
theme_bw()
ozone1 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy))) +
theme_bw() +
geom_point(mapping=aes(x=Year, y=M2), col="magenta")
ozone1 %>% ggplot(mapping=aes(x=Year, y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M3, col="magenta"))+
theme_bw()
#Ha: Intervention was effective and reduced pollution
#Ho: Intervention was not effective and did not reduce pollution
#Tolerance level alpha = 0.05 = 5%
#Carry out 2 sample t-test to assess whether the intervention was effective
before1966 = ozone %>% filter(Year < 1966)
after1966 = ozone %>% filter(Year >= 1966)
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
#Let's visualize the difference
ozone %>% ggplot(aes(group=Year, x=Year,y=ozone, fill=Year)) +
geom_boxplot(outlier.colour = 'Green') + theme(legend.position = 'none') +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_hline(yintercept=mean(before1966$ozone), color="blue")+
geom_hline(yintercept=mean(after1966$ozone), color="magenta")+
theme_bw()
# Let's implement the abrupt change using regression model
# We create a dummy variable 0/1 and call it 'dummy'
ozone2 = ozone
ozone2$Dummy = 0
ozone2 %>% tail
ozone2$Dummy[133:216] = 1
ozone2 %>% filter(Year >= 1965 & Year < 1967)
M1 = lm(ozone ~ Dummy, data=ozone2)
summary(M1)
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
# Create a graph to show how regression fits the data
ozone2$M1 = M1$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
# Let's implement the gradual change using regression model
# create ramp for gradual change
ozone2$Ramp = c(rep(0,132),1:84)
ozone2 %>% filter(Year >= 1965 & Year < 1967)
ozone2 %>% tail
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp, data=ozone2)
summary(M2)
# Create a graph to show how regression fits the data
ozone2$M2 = M2$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M2, col=as.factor(Dummy)))+
theme_bw()
#Which one do you think it is more appropriate and meaningful?
# I think a mix of abrupt and gradual change is more appropriate, so let's check it
M3 = lm(ozone ~ Dummy + Ramp, data=ozone2)
summary(M3)
# Create a graph to show how regression fits the data
ozone2$M3 = M3$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="brown")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="green")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
before1966 = after1960 %>% filter(Year < 1966)
after1966 = after1960 %>% filter(Year >= 1966)
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
#Ha: Intervention was effective and reduced pollution
#Ho: Intervention was not effective and did not reduce pollution
#Tolerance level alpha = 0.05 = 5%
#Carry out 2 sample t-test to assess whether the intervention was effective
before1966 = ozone %>% filter(Year < 1966)
after1966 = ozone %>% filter(Year >= 1966)
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
#Ha: Intervention was effective and reduced pollution
#Ho: Intervention was not effective and did not reduce pollution
#Tolerance level alpha = 0.05 = 5%
#Carry out 2 sample t-test to assess whether the intervention was effective
before1966 = ozone %>% filter(Year < 1966)
after1966 = ozone %>% filter(Year >= 1966)
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
#Let's visualize the difference
ozone %>% ggplot(aes(group=Year, x=Year,y=ozone, fill=Year)) +
geom_boxplot(outlier.colour = 'Green') + theme(legend.position = 'none') +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_hline(yintercept=mean(before1966$ozone), color="blue")+
geom_hline(yintercept=mean(after1966$ozone), color="magenta")+
theme_bw()
before1966 = after1960 %>% filter(Year < 1966)
after1966 = after1960 %>% filter(Year >= 1966)
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
#Ha: Intervention was effective and reduced pollution
#Ho: Intervention was not effective and did not reduce pollution
#Tolerance level alpha = 0.05 = 5%
#Carry out 2 sample t-test to assess whether the intervention was effective
before1966 = ozone %>% filter(Year < 1966)
after1966 = ozone %>% filter(Year >= 1966)
t.test(x= before1966$ozone, y=after1966$ozone, alternative="greater")
ozone2 = ozone %>% filter(Year >= 1960)
ozone2$Dummy = 0
ozone2 %>% tail
ozone2$Dummy[73:] = 1
ozone2 %>% tail
ozone2$Dummy[73:156] = 1
ozone2 %>% tail
ozone2
M1 = lm(ozone ~ Dummy, data=ozone2)
summary(M1)
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
# Create a graph to show how regression fits the data
ozone2$M1 = M1$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
ozone2b %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
#Let's do the same but taking only into account after 1960 intervention happened
ozone2b = ozone %>% filter(Year >= 1960)
ozone2b$Dummy = 0
ozone2b
ozone2b$Dummy[73:156] = 1
ozone2b %>% filter(Year >= 1965 & Year < 1967)
M1 = lm(ozone ~ Dummy, data=ozone2b)
summary(M1)
ozone2b %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
# Create a graph to show how regression fits the data
ozone2b$M1 = M1$fitted.values
ozone2b %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
# Let's implement the abrupt change using regression model
# We create a dummy variable 0/1 and call it 'dummy'
ozone2 = ozone
ozone2$Dummy = 0
ozone2$Dummy = 0
ozone2$Dummy[133:216] = 1
ozone2 %>% filter(Year >= 1965 & Year < 1967)
M1 = lm(ozone ~ Dummy, data=ozone2)
summary(M1)
# since in lm output p-values are two sided...
# p-value = 2.38e-07/2 = 0.000000119
# Create a graph to show how regression fits the data
ozone2$M1 = M1$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy)))+
theme_bw()
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M2, col=as.factor(Dummy)))+
theme_bw()
# Let's implement the gradual change using regression model
# create ramp for gradual change
ozone2$Ramp = c(rep(0,132),1:84)
ozone2 %>% filter(Year >= 1965 & Year < 1967)
ozone2 %>% tail
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp, data=ozone2)
summary(M2)
# since in lm output p-values are two sided...
# p-value = 1.6e-08/2 = 0.000000008
# Create a graph to show how regression fits the data
ozone2$M2 = M2$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M2, col=as.factor(Dummy)))+
theme_bw()
ozone2b$Ramp = c(rep(0,72),1:84)
ozone2 %>% filter(Year >= 1965 & Year < 1967)
ozone2b %>% filter(Year >= 1965 & Year < 1967)
ozone2 %>% tail
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp, data=ozone2b)
summary(M2)
# since in lm output p-values are two sided...
# p-value = 1.6e-08/2 = 0.000000008
# Create a graph to show how regression fits the data
ozone2$M2 = M2$fitted.values
# since in lm output p-values are two sided...
# p-value = 1.6e-08/2 = 0.000000008
# Create a graph to show how regression fits the data
ozone2b$M2 = M2$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M2, col=as.factor(Dummy)))+
theme_bw()
M3 = lm(ozone ~ Dummy + Ramp, data=ozone2)
summary(M3)
# Create a graph to show how regression fits the data
ozone2$M3 = M3$fitted.values
ozone2 %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year,y=M1),col="green")+
theme_bw() +geom_point(mapping=aes(x=Year,y=M2),col="magenta")+
geom_point(mapping=aes(x=Year,y=M3),col="blue")
#5 Can you capture both interventions, the opening of the Golden State Freeway
#and the implementation of Rule 63  in 1960, and the regulations for new car
#engines implemented in 1966 in one model? Can you model both interventions
#and both abrupt and gradual changes?
# Let's implement the abrupt change using regression model
# We create a dummy variable 0/1 and call it 'dummy'
ozone$Dummy1 = 0
ozone$Dummy1[61:216] = 1
ozone$Dummy2 = 0
ozone$Dummy2[133:216] = 1
ozone %>% tail
M1 = lm(ozone ~ Dummy1 + Dummy2, data=ozone)
summary(M1)
# Create a graph to show how regression fits the data
ozone$M1 = M1$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy1)))+
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy2)))+
theme_bw()
# Let's implement the gradual change using regression model
# create ramp for gradual change
ozone$Ramp1 = c(rep(0,60),1:156)
ozone$Ramp2 = c(rep(0,132),1:84)
ozone
# now capture Ramp using regression model
M2 = lm(ozone ~ Ramp1 + Ramp2, data=ozone)
summary(M2)
# since in lm output p-values are two sided...
# p-value for Ramp0 = 0.0001/2 = 0.00005
# p-value for Ramp = 0.466/2 = 0.233
# Create a graph to show how regression fits the data
ozone$M2 = M2$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() + geom_point(mapping=aes(x=Year,y=M2), col="magenta")
#M3 = lm(ozone ~ Dummy1 + Dummy2 + Ramp1 + Ramp2, data=ozone)
M3 = lm(ozone ~ Dummy1 + Ramp1 + Dummy2 + Ramp2, data=ozone)
summary(M3)
# Create a graph to show how regression fits the data
ozone$M3 = M3$fitted.values
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +
geom_point(mapping=aes(x=Year,y=M3),col="blue")
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1960, color="red", size=0.2) +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy1)))+
geom_point(mapping=aes(x=Year, y=M1, col=as.factor(Dummy2)))+
theme_bw()
summary(M1)
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() + geom_point(mapping=aes(x=Year,y=M2), col="magenta")
ozone %>% ggplot(mapping=aes(x=Year,y=ozone)) + geom_point() +
geom_vline(xintercept=1966, color="red", size=0.2) +
geom_vline(xintercept=1960, color="red", size=0.2) +
theme_bw() +
geom_point(mapping=aes(x=Year,y=M3),col="blue")
